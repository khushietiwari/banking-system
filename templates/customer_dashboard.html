{% extends 'base.html' %}
{% block content %}

<div class="dashboard-container">

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <h3 class="brand mb-4">PrimeTrust</h3>

        <a href="{% url 'customer_dashboard' %}">ğŸ  Dashboard</a>
        <a href="{% url 'transaction_history' %}">ğŸ“œ Statements</a>
        <a href="{% url 'transfer' %}">ğŸ” Transfer Funds</a>
        <a href="{% url 'pay_bills' %}">ğŸ§¾ Pay Bills</a>
        <a href="{% url 'manage_profile' %}">âš™ Manage Profile</a>
        <a href="{% url 'deposit' %}">â• Deposit</a>
        <a href="{% url 'withdraw' %}">â– Withdraw</a>

        <form method="POST" action="{% url 'logout' %}" class="mt-4">
            {% csrf_token %}
            <button type="submit" class="sidebar-link logout-link w-100 text-start">
                ğŸšª Logout
            </button>
        </form>
    </div>

    <!-- Main Content -->
    <div class="main-content">

        <!-- Greeting Bar with Toggle -->
        <div class="top-bar mb-4">

            <!-- Toggle Button -->
            <button onclick="toggleSidebar()" 
                style="border:none;background:#003366;color:white;
                       padding:8px 12px;border-radius:6px;margin-right:15px;">
                â˜°
            </button>

            <!-- Greeting -->
            <div style="flex:1;">
                <h2 class="mb-1 fw-bold">Welcome Back, {{ name }} ğŸ‘‹</h2>
                <small class="text-muted">Here's your account overview</small>
            </div>

            <!-- Profile Circle -->
            <div class="profile-circle">
                {{ name|first|upper }}
            </div>
        </div>

        <!-- KYC Warning Banner -->
        {% if not kyc or kyc.status != "Approved" %}
        <div style="
            background:#fff4e5;
            border-left:4px solid #ff9800;
            padding:14px 18px;
            border-radius:8px;
            margin-bottom:25px;
            font-weight:500;
        ">
            âš  Please complete KYC verification to unlock full banking features.
        </div>
        {% endif %}

        <!-- Balance Card -->
        <div class="balance-card">
            <p style="opacity:0.85;margin-bottom:8px;">Available Balance</p>
            <h1 style="font-weight:700;letter-spacing:1px;">â‚¹ {{ balance }}</h1>

            <div style="margin-top:15px;">
                <small style="display:block;opacity:0.85;">
                    Account No: {{ account_number }}
                </small>
                <small style="display:block;opacity:0.85;">
                    IFSC Code: {{ ifsc }}
                </small>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="mt-4 mb-3">
            <h4 class="fw-semibold">Quick Actions</h4>
            <hr style="width:60px;height:3px;background:#003366;border:none;">
        </div>

        <div class="action-grid">

            <a href="{% url 'view_balance' %}" class="text-decoration-none">
                <div class="action-box blue">
                    ğŸ’°
                    <h5>View Balance</h5>
                </div>
            </a>

            <a href="{% url 'deposit' %}" class="text-decoration-none">
                <div class="action-box green">
                    â•
                    <h5>Deposit</h5>
                </div>
            </a>

            <a href="{% url 'withdraw' %}" class="text-decoration-none">
                <div class="action-box red">
                    â–
                    <h5>Withdraw</h5>
                </div>
            </a>

            <a href="{% url 'transaction_history' %}" class="text-decoration-none">
                <div class="action-box purple">
                    ğŸ“œ
                    <h5>Statements</h5>
                </div>
            </a>

            <a href="{% url 'transfer' %}" class="text-decoration-none">
                <div class="action-box green">
                    ğŸ”
                    <h5>Transfer Funds</h5>
                </div>
            </a>

            <a href="{% url 'pay_bills' %}" class="text-decoration-none">
                <div class="action-box yellow">
                    ğŸ§¾
                    <h5>Pay Bills</h5>
                </div>
            </a>

            <a href="{% url 'manage_profile' %}" class="text-decoration-none">
                <div class="action-box blue">
                    âš™
                    <h5>Manage Profile</h5>
                </div>
            </a>

        </div>

        <!-- KYC Section -->
        <div class="mt-5 mb-3">
            <h4 class="fw-semibold">KYC Verification</h4>
            <hr style="width:60px;height:3px;background:#003366;border:none;">
        </div>

        <div class="action-grid">

            {% if not kyc %}
                <a href="{% url 'upload_kyc' %}" class="text-decoration-none">
                    <div class="action-box yellow">
                        ğŸªª
                        <h5>Upload KYC</h5>
                    </div>
                </a>

            {% elif kyc.status == "Pending" %}
                <div class="action-box purple">
                    â³
                    <h5>KYC Pending</h5>
                </div>

            {% elif kyc.status == "Rejected" %}
                <a href="{% url 'upload_kyc' %}" class="text-decoration-none">
                    <div class="action-box red">
                        âŒ
                        <h5>KYC Rejected - Reupload</h5>
                    </div>
                </a>

            {% elif kyc.status == "Approved" %}
                <div class="action-box green">
                    âœ…
                    <h5>KYC Approved</h5>
                </div>
            {% endif %}

        </div>

        <!-- Loan Section -->
        <div class="mt-5 mb-3">
            <h4 class="fw-semibold">Loans</h4>
            <hr style="width:60px;height:3px;background:#003366;border:none;">
        </div>

        <div class="action-grid">

            <a href="{% url 'apply_loan' %}" class="text-decoration-none">
                <div class="action-box blue">
                    ğŸ’³
                    <h5>Apply Loan</h5>
                </div>
            </a>

            <a href="{% url 'my_loans' %}" class="text-decoration-none">
                <div class="action-box purple">
                    ğŸ“‹
                    <h5>My Loans</h5>
                </div>
            </a>

        </div>

        <!-- Recent Activity -->
        <div class="recent-section mt-5">
            <h4 class="fw-semibold mb-3">Recent Transactions</h4>

            <div class="recent-card text-center py-4">
                <p class="mb-1">No recent transactions yet.</p>
                <small class="text-muted">
                    Your latest transactions will appear here.
                </small>
            </div>
        </div>

    </div>

</div>

<script>
function toggleSidebar() {
    const sidebar = document.getElementById("sidebar");

    if (sidebar.style.display === "none") {
        sidebar.style.display = "flex";
    } else {
        sidebar.style.display = "none";
    }
}
</script>

{% endblock %}
