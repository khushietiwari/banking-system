{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PrimeTrust Bank • Loan Requests</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>

/* ===== GLOBAL ===== */
body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #0b1f3a, #102a4d);
    color: white;
}

/* ===== CONTAINER ===== */
.page-container {
    max-width: 1100px;
    margin: auto;
    padding: 40px 20px;
}

/* ===== CARD ===== */
.requests-card {
    background: white;
    border-radius: 20px;
    padding: 25px;
    box-shadow: 0 25px 70px rgba(0,0,0,0.35);
    color: #102a4d;
}

/* ===== TABLE ===== */
.table thead {
    border-bottom: 2px solid #dde2e7;
}

.table tbody tr:hover {
    background: #f4f7fb;
}

/* ===== BADGES ===== */
.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

/* Pending */
.pending {
    background: rgba(255,193,7,0.25);
    color: #b78103;
}

/* Approved */
.approved {
    background: rgba(40,167,69,0.15);
    color: #28a745;
}

/* Rejected */
.rejected {
    background: rgba(220,53,69,0.15);
    color: #dc3545;
}

/* ===== BUTTONS ===== */
.btn-approve {
    background: #28a745;
    border: none;
}

.btn-reject {
    background: #dc3545;
    border: none;
}

/* ===== EMPTY STATE ===== */
.empty-row {
    text-align: center;
    color: #6c757d;
}

</style>
</head>

<body>

<div class="page-container">

    <h3 class="mb-3">Loan Requests</h3>

    <div class="requests-card">

        <table class="table align-middle table-borderless">

            <thead>
                <tr>
                    <th>User</th>
                    <th>Amount</th>
                    <th>Reason</th>
                    <th>Status</th>
                    <th class="text-end">Action</th>
                </tr>
            </thead>

            <tbody>
            {% for loan in loans %}
                <tr>

                    <td>{{ loan.user.username }}</td>

                    <td><strong>₹ {{ loan.amount }}</strong></td>

                    <td>{{ loan.reason }}</td>

                    <td>
                        {% if loan.status == "Pending" %}
                            <span class="status-badge pending">Pending</span>
                        {% elif loan.status == "Approved" %}
                            <span class="status-badge approved">Approved</span>
                        {% else %}
                            <span class="status-badge rejected">Rejected</span>
                        {% endif %}
                    </td>

                    <td class="text-end">
                        {% if loan.status == "Pending" %}
                            <a href="{% url 'update_loan' loan.id 'approve' %}" 
                               class="btn btn-sm btn-success">
                                Approve
                            </a>

                            <a href="{% url 'update_loan' loan.id 'reject' %}" 
                               class="btn btn-sm btn-danger">
                                Reject
                            </a>
                        {% else %}
                            <span class="text-muted">No Action</span>
                        {% endif %}
                    </td>

                </tr>

            {% empty %}
                <tr>
                    <td colspan="5" class="empty-row py-4">
                        No loan requests found.
                    </td>
                </tr>
            {% endfor %}
            </tbody>

        </table>

    </div>

</div>

</body>
</html>
